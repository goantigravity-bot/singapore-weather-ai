#!/bin/bash
# run_training.sh
# шЗкхКишонч╗ГшДЪцЬмя╝ЪшО╖хПЦцХ░цНоуАБшонч╗ГцибхЮЛуАБф╕Кф╝ахИ░ S3

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
cd "$SCRIPT_DIR"

# ц┐Ац┤╗шЩЪцЛЯчОпхвГ
source venv/bin/activate

echo "============================================"
echo "ЁЯЪА х╝АхзЛшЗкхКишонч╗Гц╡БчиЛ"
echo "   цЧ╢щЧ┤: $(date)"
echo "============================================"

# 1. шО╖хПЦцЬАцЦ░цХ░цНо
echo ""
echo "ЁЯУб цнещкд 1: шО╖хПЦцЬАцЦ░хдйц░ФцХ░цНо..."
python fetch_and_process_gov_data.py

# 2. ш┐РшбМхвЮщЗПшонч╗Г
echo ""
echo "ЁЯза цнещкд 2: ш┐РшбМцибхЮЛшонч╗Г..."
python train_rolling_window.py

# 3. хРМцнецибхЮЛхИ░ S3
echo ""
echo "тШБя╕П  цнещкд 3: хРМцнецибхЮЛхИ░ S3..."
./sync_model_to_s3.sh

echo ""
echo "============================================"
echo "тЬЕ шонч╗Гц╡БчиЛхоМцИР"
echo "   цЧ╢щЧ┤: $(date)"
echo "============================================"
